@using Newtonsoft.Json
@using Newtonsoft.Json.Serialization
<!-- Banner -->
<div class="banner position-relative bg-black overflow-hidden" style="height: 500px;">
    <img src="~/images/default-banner-detail.jpg" alt="banner dan da dan"
         class="d-block mx-auto h-100 object-fit-cover" />
    <button type="button"
            class="play-button position-absolute top-50 start-50 translate-middle border-0 bg-transparent">
        <img src="/images/button-play.png" alt="Play" class="play-icon img-fluid" />
    </button>
</div>

<!-- Wrapper Galaxy Style -->
<div class="wrapper-section bg-white py-4 px-3 px-md-4 px-lg-5 mx-auto" style="max-width: 1200px;">
<!-- Movie Section (thumbnail đè vào banner ~60px) -->
<div class="container movie_section position-relative" style="margin-top: -60px;">
    <div class="row align-items-end g-4">
        <!-- Thumbnail -->
        <div class="col-md-3">
                <div class="thumbnail-wrapper">
                <img src="~/images/default_thumbnail.jpg"
                     alt="Thumbnail"
                     class="img-fluid thumbnail-img" />
            </div>
        </div>

        <!-- Movie Details-->
        <div class="col-md-9 mt-md-5 mt-4">
            <div class="movie_details pt-4 ps-md-4">
                <h3 class="fw-bold">
                    Dan Da Dan: Tà Nhãn <span class="badge bg-warning text-white">T16</span>
                </h3>
                <p class="mb-1 text-muted"><i class="bi bi-clock"></i> 93 phút | <i class="bi bi-calendar"></i> 13/06/2025</p>
                <p class="mb-2"><i class="bi bi-star-fill text-warning"></i> <strong>9.5</strong> (14 votes)</p>
                <p><strong>Quốc gia:</strong> Nhật Bản</p>
                <p><strong>Nhà sản xuất:</strong> Science SARU</p>
                    <!-- Thể loại -->
                    <div class="mb-2 d-flex flex-wrap align-items-center">
                        <span class="fw-semibold text-muted me-2" style="min-width: 90px;">Thể loại:</span>
                        <div class="d-flex flex-wrap gap-2">
                            <span class="badge-tag">Hoạt Hình</span>
                            <span class="badge-tag">Phiêu Lưu</span>
                        </div>
                    </div>

                    <!-- Đạo diễn -->
                    <div class="mb-2 d-flex flex-wrap align-items-center">
                        <span class="fw-semibold text-muted me-2" style="min-width: 90px;">Đạo diễn:</span>
                        <div class="d-flex flex-wrap gap-2">
                            <span class="badge-tag">Abel</span>
                            <span class="badge-tag">Yamashiro Fuuga</span>
                        </div>
                    </div>

                    <!-- Diễn viên -->
                    <div class="mb-2 d-flex flex-wrap align-items-center">
                        <span class="fw-semibold text-muted me-2" style="min-width: 90px;">Diễn viên:</span>
                        <div class="d-flex flex-wrap gap-2">
                            <span class="badge-tag">Ayase Momo</span>
                            <span class="badge-tag">Takakura Ken</span>
                            <span class="badge-tag">Enjoji Jin</span>
                        </div>
                    </div>

            </div>
        </div>
    </div>
</div>


<!-- Modal -->
<div class="modal fade" id="trailerModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content bg-black">
            <div class="modal-body p-0 position-relative">
                <button type="button" class="btn-close position-absolute top-0 end-0 m-2" data-bs-dismiss="modal" aria-label="Close"></button>
                <div class="ratio ratio-16x9">
                    <div id="player"></div> <!-- YouTube Player sẽ gắn vào đây -->
                </div>
            </div>
        </div>
    </div>
</div>




<div class="movie_content mt-4">
    <div class="d-flex align-items-center mb-3">
        <div class="border-start border-4 border-primary me-2" style="height: 1.25rem;"></div>
        <h5 class="fw-bold mb-0 text-capitalize">Nội dung phim</h5>
    </div>

    <div class="content-text text-secondary fs-6" style="line-height: 1.8;">
        <p>
            <strong>Dan Da Dan: Evil Eye</strong> là
            <a href="#" class="text-decoration-none text-primary">phim hay</a> hoạt hình đang thu hút đông đảo khán giả toàn cầu.
        </p>

        <p>
            Để điều tra vụ việc liên quan tới gia đình Jiji, Momo và Okarun tới nhà của Jiji ở khu suối nước nóng. Trên đường đi,
            Okarun luôn phiền muộn vì bầu không khí giữa Momo và Jiji. Tuy nhiên, lại bắt đầu cảm mến vì bản tính tốt đẹp của Jiji.
            Sau khi leo lên ngôi nhà trên núi của Jiji, cả ba ngay lập tức điều tra. Xa xa, có bóng người quan sát họ…
        </p>

        <p>
            <strong>Dan Da Dan: Evil Eye</strong>/ <strong>Dan Da Dan: Tà Nhãn</strong> dự kiến khởi chiếu 13.06.2025 tại các
            <a href="#" class="text-decoration-none text-primary">rạp chiếu phim</a> toàn quốc.
        </p>
    </div>
</div>

    <!-- Lịch chiếu -->
    <div class="movie_showtime mt-5">
        <div class="d-flex align-items-center mb-3">
            <div class="border-start border-4 border-primary me-2" style="height: 1.25rem;"></div>
            <h5 class="fw-bold mb-0 text-capitalize">Lịch chiếu</h5>
        </div>

        <!-- Bộ lọc ngày + vùng + rạp -->
        <div class="row align-items-center gy-3">
            <div class="col-md-7">
                <div class="d-flex gap-2 flex-wrap" id="date-buttons">
                    @{
                        var availableDates = Model.AvailableDates ?? new List<DateTime>();
                        var selectedDate = Model.SelectedDate.Date;
                    }

                    @foreach (var date in availableDates)
                    {
                        var isActive = date.Date == selectedDate;
                        <button type="button" class="btn @(isActive ? "btn-primary text-white" : "btn-outline-secondary")"
                                data-date="@date.ToString("yyyy-MM-dd")">
                            @date.ToString("dddd", new System.Globalization.CultureInfo("vi-VN"))<br />
                            @date.ToString("dd/MM")
                        </button>
                    }
                </div>
            </div>

            <div class="col-md-5 text-md-end">
                <div class="row g-2">
                    <div class="col">
                        <select id="region-select" class="form-select form-select-sm">
                            @foreach (var region in Model.Regions)
                            {
                                <option value="@region">@region</option>
                            }
                        </select>
                    </div>
                    <div class="col">
                        <select id="cinema-select" class="form-select form-select-sm">
                            <option value="">Tất cả rạp</option>
                            @foreach (var cinema in Model.Cinemas)
                            {
                                <option value="@cinema.MaRap" data-region="@cinema.Region">
                                    @cinema.TenRap
                                </option>
                            }
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Danh sách lịch chiếu -->
        <div class="mt-4" id="showtime-list">
            <!-- Sẽ được render bằng JS -->
        </div>
    </div>

    <!-- Dữ liệu showtimes (dạng JSON) -->
    <script type="application/json" id="all-showtimes-data">
        @Html.Raw(Model.AllShowtimesRawJson)
    </script>

</div>


@section Scripts {
    <script src="~/js/play-trailer.js" defer></script>
    <script src="~/js/movie-showtime.js" asp-append-version="true"></script>
}



